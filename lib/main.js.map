{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/main.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'DBAY-CMUDICT'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nPATH                      = require 'path'\ntypes                     = require './types'\n{ isa\n  type_of\n  validate\n  validate_list_of }      = types.export()\nSQL                       = String.raw\nguy                       = require 'guy'\nhome                      = PATH.resolve PATH.join __dirname, '..'\ndata_path                 = PATH.join home, 'data'\nBRITFONE                  = require 'britfone'\n\n#===========================================================================================================\nclass @Cmud\n\n  #---------------------------------------------------------------------------------------------------------\n  @C: guy.lft.freeze\n    replacement:  '█'\n    defaults:\n      #.....................................................................................................\n      constructor_cfg:\n        db:               null\n        prefix:           'cmud_'\n        schema:           'cmud'\n        path:             PATH.join home,      'cmudict.sqlite'\n        paths:\n          cmu:            PATH.join data_path, 'cmudict-0.7b'\n          beep:           PATH.join data_path, 'beep/beep-1.0'\n          bf_expansions:  BRITFONE.expansions\n          bf_main:        BRITFONE.main\n          bf_symbols:     BRITFONE.symbols\n          spellings:      PATH.join data_path, 'beep/case.txt'\n          abipa:          PATH.join data_path, 'arpabet-to-ipa.tsv'\n          xsipa:          PATH.join data_path, 'xsampa-to-ipa.tsv'\n        create:           false\n        max_entry_count:  Infinity\n\n  #---------------------------------------------------------------------------------------------------------\n  @cast_constructor_cfg: ( me, cfg = null ) ->\n    clasz           = me.constructor\n    R               = cfg ? me.cfg\n    # #.......................................................................................................\n    # if R.path?\n    #   R.temporary  ?= false\n    #   R.path        = PATH.resolve R.path\n    # else\n    #   R.temporary  ?= true\n    #   filename        = me._get_random_filename()\n    #   R.path        = PATH.resolve PATH.join clasz.C.autolocation, filename\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  @declare_types: ( me ) ->\n    ### called from constructor via `guy.cfg.configure_with_types()` ###\n    me.cfg        = @cast_constructor_cfg me\n    me.types.validate.constructor_cfg me.cfg\n    { db, }       = guy.obj.pluck_with_fallback me.cfg, null, 'db'\n    me.cfg        = guy.lft.freeze guy.obj.omit_nullish me.cfg\n    guy.props.def me, 'db',     { enumerable: false, value: db, }\n    guy.props.def me, 'cache',  { enumerable: false, value: {}, }\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( cfg ) ->\n    guy.cfg.configure_with_types @, cfg, types\n    @_compile_sql()\n    @_create_sql_functions()\n    @_open_cmu_db()\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  _create_db_structure: ->\n    { prefix\n      schema } = @cfg\n    @db.execute SQL\"\"\"\n      drop index if exists #{schema}.entries_word_idx;\n      drop index if exists #{schema}.entries_ipa_idx;\n      drop table if exists #{schema}.trlits;\n      drop table if exists #{schema}.trlit_nicks;\n      drop table if exists #{schema}.abs_phones;\n      drop table if exists #{schema}.entries;\n      drop table if exists #{schema}.source_nicks;\n      -- ...................................................................................................\n      vacuum #{schema};\n      -- ...................................................................................................\n      create table #{schema}.entries (\n          id        integer not null primary key,\n          word      text    not null,\n          source    text    not null references source_nicks ( nick ),\n          nr        integer not null default 1,\n          ipa       text    not null,\n          ipa_raw   text    not null );\n      create index #{schema}.entries_word_idx on entries ( word );\n      create index #{schema}.entries_ipa_idx  on entries ( ipa );\n      -- ...................................................................................................\n      create table #{schema}.trlits ( -- trlits: transliterations\n          ipa         text    not null,\n          nick        text    not null references trlit_nicks ( nick ),\n          trlit       text    not null,\n          example     text,\n        primary key ( ipa, nick ) );\n      create table #{schema}.trlit_nicks (\n          nick        text    not null,\n          name        text    not null,\n          comment     text,\n        primary key ( nick ) );\n      create table #{schema}.source_nicks (\n          nick        text    not null,\n          name        text    not null,\n          comment     text,\n        primary key ( nick ) );\n      \"\"\"\n      # -- -- ...................................................................................................\n      # -- create view #{schema}.abs_phones as select\n      # --     r1.word   as word,\n      # --     r2.lnr    as lnr,\n      # --     r2.rnr    as rnr,\n      # --     r2.part   as abs1_phone\n      # --   from\n      # --     entries                           as r1,\n      # --     std_str_split_re( r1.abs1, '\\s' ) as r2;\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _compile_sql: ->\n    { prefix\n      schema }  = @cfg\n    sql         =\n      get_db_object_count:  SQL\"select count(*) as count from #{schema}.sqlite_schema;\"\n      truncate_entries:     SQL\"delete from #{schema}.entries where source = $source;\"\n      insert_entry: SQL\"\"\"\n        insert into #{schema}.entries ( word, source, nr, ipa_raw, ipa )\n          values ( $word, $source, $nr, $ipa_raw, $ipa );\"\"\"\n      insert_trlit: SQL\"\"\"\n        insert into #{schema}.trlits ( ipa, nick, trlit, example )\n          values ( $ipa, $nick, $trlit, $example );\"\"\"\n      upsert_source_nick: SQL\"\"\"\n        insert into #{schema}.source_nicks ( nick, name, comment )\n          values ( $nick, $name, $comment )\n          on conflict ( nick ) do update set\n            name = excluded.name, comment = excluded.comment;\"\"\"\n      upsert_trlit_nick: SQL\"\"\"\n        insert into #{schema}.trlit_nicks ( nick, name, comment )\n          values ( $nick, $name, $comment )\n          on conflict ( nick ) do update set\n            name = excluded.name, comment = excluded.comment;\"\"\"\n      delete_arpabet_trlits: SQL\"\"\"\n        delete from #{schema}.trlits\n          where nick in ( 'ab1', 'ab2' );\n        \"\"\"\n      # insert_abs_phones: SQL\"\"\"\n      #   insert into #{schema}.abs_phones ( word, lnr, rnr, abs0_phone, abs1_phone, stress )\n      #     values ( $word, $lnr, $rnr, $abs0_phone, $abs1_phone, $stress );\"\"\"\n    guy.props.def @, 'sql', { enumerable: false, value: sql, }\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _create_sql_functions: ->\n    { prefix\n      schema } = @cfg\n    # #-------------------------------------------------------------------------------------------------------\n    # @db.create_function\n    #   name:           prefix + 'ipa_from_abs1'\n    #   deterministic:  true\n    #   varargs:        false\n    #   call:           ( abs1 ) => @ipa_from_abs1( abs1 )\n    #.......................................................................................................\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _get_db_object_count:   -> @db.single_value @sql.get_db_object_count\n  _truncate_entries:      ( source ) -> @db @sql.truncate_entries, { source, }\n  _delete_arpabet_trlits: -> @db @sql.delete_arpabet_trlits\n\n  #---------------------------------------------------------------------------------------------------------\n  _open_cmu_db: ->\n    @db.open @cfg\n    if @cfg.create or ( @_get_db_object_count() is 0 )\n      @_create_db_structure()\n      @_populate_db()\n    else\n      null\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _populate_db: ->\n    @_populate_arpabet_trlits()\n    # @_populate_xsampa_to_ipa()\n    @_cache_spellings()\n    @_populate_cmu_entries()\n    @_populate_beep_entries()\n    @_populate_bf_entries()\n\n  #---------------------------------------------------------------------------------------------------------\n  _populate_cmu_entries: ->\n    count         = 0\n    insert_entry  = @db.prepare @sql.insert_entry\n    source        = 'cmu'\n    @_truncate_entries source\n    @db @sql.upsert_source_nick, { nick: source, name: \"CMUdict\", comment: \"v0.7b\", }\n    @db =>\n      for line from guy.fs.walk_lines @cfg.paths.cmu\n        continue if line.startsWith ';;;'\n        line                  = line.trimEnd()\n        [ word, ab, ]         = line.split '\\x20\\x20'\n        word                  = word.trim()\n        if ( not word? ) or ( word.length is 0 ) or ( not ab? ) or ( ab.length is 0 )\n          warn '^4443^', count, ( rpr line )\n          continue\n        #...................................................................................................\n        count++\n        if count > @cfg.max_entry_count\n          warn '^dbay-cmudict/main@1^', \"shortcutting at #{@cfg.max_entry_count} entries\"\n          break\n        { word\n          nr    } = @_get_bracketed_nr word\n        word      = word.toLowerCase()\n        word      = @cache.spellings[ word ] ? word ### replace LC variant with correct upper/lower case where found ###\n        ipa_raw   = @ipa_raw_from_arpabet2  ab\n        ipa       = @ipa_from_cmu_ipa_raw       ipa_raw\n        insert_entry.run { word, source, nr, ipa_raw, ipa, }\n      return null\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _populate_beep_entries: ->\n    count         = 0\n    insert_entry  = @db.prepare @sql.insert_entry\n    source        = 'be'\n    nr            = 1\n    @_truncate_entries source\n    @db @sql.upsert_source_nick, { nick: source, name: \"BEEP\", comment: \"v1.0\", }\n    @db =>\n      for line from guy.fs.walk_lines @cfg.paths.beep\n        continue if line.startsWith '#'\n        line = line.trim()\n        continue if line.length is 0\n        continue unless ( match = line.match /(?<word>\\S+)\\s+(?<ab>.*)$/ )?\n        { word\n          ab    } = match.groups\n        if ( word.length is 0 ) or ( ab.length is 0 )\n          warn '^4443^', count, ( rpr line )\n          continue\n        #...................................................................................................\n        count++\n        if count > @cfg.max_entry_count\n          warn '^dbay-cmudict/main@2^', \"shortcutting at #{@cfg.max_entry_count} entries\"\n          break\n        word      = word.toLowerCase()\n        word      = @cache.spellings[ word ] ? word ### replace LC variant with correct upper/lower case where found ###\n        word      = @_rewrite_beep_word word\n        ipa_raw   = @ipa_raw_from_arpabet2  ab\n        ipa       = @ipa_from_beep_ipa_raw  ipa_raw\n        insert_entry.run { word, source, nr, ipa_raw, ipa, }\n      return null\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _populate_bf_entries: ->\n    count         = 0\n    insert_entry  = @db.prepare @sql.insert_entry\n    source        = 'bf'\n    @_truncate_entries source\n    @db @sql.upsert_source_nick, { nick: source, name: \"Britfone\", comment: \"v3.0.1\", }\n    @db =>\n      for line from guy.fs.walk_lines @cfg.paths.bf_main\n        continue if line.startsWith '#'\n        line = line.trim()\n        continue if line.length is 0\n        continue unless ( match = line.match /(?<word>[^,]+),\\s*(?<ipa_raw>.*)$/ )?\n        { word\n          ipa_raw } = match.groups\n        if ( word.length is 0 ) or ( ipa_raw.length is 0 )\n          warn '^4443^', count, ( rpr line )\n          continue\n        #...................................................................................................\n        count++\n        if count > @cfg.max_entry_count\n          warn '^dbay-cmudict/main@2^', \"shortcutting at #{@cfg.max_entry_count} entries\"\n          break\n        { word\n          nr    } = @_get_bracketed_nr word\n        word      = word.toLowerCase()\n        word      = @cache.spellings[ word ] ? word ### replace LC variant with correct upper/lower case where found ###\n        # word      = word.replace /_/g, '\\x20'\n        ipa       = @ipa_from_britfone_ipa_raw  ipa_raw\n        insert_entry.run { word, source, nr, ipa_raw, ipa, }\n      return null\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _cache_spellings: ->\n    cache = ( @cache.spellings ?= {} )\n    count = 0\n    for line from guy.fs.walk_lines @cfg.paths.spellings\n      continue if line.startsWith '#'\n      line = line.trim()\n      continue if line.length is 0\n      continue unless ( match = line.match /(?<lc>\\S+)\\s+(?<spelling>.*)$/ )?\n      #.....................................................................................................\n      count++\n      if count > @cfg.max_entry_count\n        warn '^dbay-cmudict/main@3^', \"shortcutting at #{@cfg.max_entry_count} entries\"\n        break\n      #.....................................................................................................\n      { lc,\n        spelling, } = match.groups\n      lc            = lc.toLowerCase()\n      spelling      = spelling.trimEnd()\n      cache[ lc ]   = spelling\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _populate_arpabet_trlits: ->\n    @_delete_arpabet_trlits()\n    line_nr       = 0\n    insert_trlit  = @db.prepare @sql.insert_trlit\n    @db @sql.upsert_trlit_nick, { nick: 'ab1', name: \"ARPAbet1\", comment: null, }\n    @db @sql.upsert_trlit_nick, { nick: 'ab2', name: \"ARPAbet2\", comment: null, }\n    @db =>\n      for line from guy.fs.walk_lines @cfg.paths.abipa\n        line_nr++\n        line              = line.trim()\n        continue if line.length is 0\n        continue if line.startsWith '#'\n        fields            = line.split '\\t'\n        fields[ idx ]     = field.trim() for field, idx in fields\n        fields[ idx ]     = null for field, idx in fields when field is 'N/A'\n        [ cv\n          ab1\n          ab2\n          ipa\n          example ]       = fields\n        ab1               = ab1.toLowerCase() if ab1\n        ab2               = ab2.toLowerCase()\n        example           = example.replace /\\x20/g, ''\n        insert_trlit.run { ipa, nick: 'ab1', trlit: ab1, example, } if ab1?\n        insert_trlit.run { ipa, nick: 'ab2', trlit: ab2, example, }\n      return null\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _undoublequote: ( text ) ->\n    return text unless text[ 0                          ] is '\"'\n    return text unless text[ last_idx = text.length - 1 ] is '\"'\n    return text[ 1 ... last_idx ]\n\n  #---------------------------------------------------------------------------------------------------------\n  _populate_xsampa_to_ipa: ->\n    @_truncate_xsipa()\n    line_nr     = 0\n    xs_by_ipa   = {} ### #cache ###\n    insert      = @db.prepare @sql.insert_xsipa\n    @db =>\n      for line from guy.fs.walk_lines @cfg.paths.xsipa\n        line_nr++\n        line              = line.trim()\n        continue if line.length is 0\n        continue if line.startsWith '#'\n        fields            = line.split '\\t'\n        fields[ idx ]     = field.trim() for field, idx in fields\n        # fields[ idx ]     = null for field, idx in fields when field is 'N/A'\n        [ xs\n          ipa\n          _\n          description\n          example ]       = fields\n        example          ?= \"(no example)\"\n        example           = @_undoublequote example\n        example           = example.replace /\\\\\"/g, '\"'\n        xs_by_ipa[ ipa ]  = xs ### #cache ###\n        insert.run { description, xs, ipa, example, }\n      return null\n    xs_by_ipa = guy.lft.freeze xs_by_ipa ### #cache ###\n    guy.props.def @, 'xs_by_ipa', { enumerable: false, value: xs_by_ipa, } ### #cache ###\n    return null\n\n  #=========================================================================================================\n  #\n  #---------------------------------------------------------------------------------------------------------\n  _build_cache_ipa_raw_from_arpabet2: ->\n    R = {}\n    for row from @db SQL\"select * from #{@cfg.schema}.trlits where nick = 'ab2';\"\n      R[ row.trlit ] = row.ipa\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  ipa_raw_from_arpabet2: ( ab ) ->\n    cache       = ( @cache.ipa_raw_from_arpabet2 ?= @_build_cache_ipa_raw_from_arpabet2() )\n    replacement = @constructor.C.replacement\n    R           = []\n    ab          = ab.trim().toLowerCase()\n    for phone in ab.split /\\x20+/\n      stress  = null\n      if ( match = phone.match /^(?<base>\\D+)(?<level>\\d*)$/ )?\n        { base\n          level } = match.groups\n        for letter in Array.from ( cache[ base ] ? replacement )\n          R.push letter + level\n      else\n        R.push cache[ phone ] ? replacement\n    return R.join ' '\n\n  #---------------------------------------------------------------------------------------------------------\n  ipa_from_cmu_ipa_raw: ( ipa_raw ) ->\n    R = ipa_raw\n    R = ',' + ( R.replace /\\x20+/g, ',' ) + ','\n    R = R.replace /,ʌ([02]),/g,     ',ə$1,'\n    R = R.replace /,ɝ0,/g,          ',ə0,r,'\n    R = R.replace /,ɝ1,/g,          ',ɜ1,r,'\n    R = R.replace /,ɝ2,/g,          ',ɜ2,r,'\n    R = R.replace /,/g,             ''\n    R = R.replace /0/g,             ''\n    R = R.replace /1/g,             '̲'\n    R = R.replace /2/g,             '̤'\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  ipa_from_beep_ipa_raw: ( ipa_raw ) ->\n    R = ipa_raw\n    R = ',' + ( R.replace /\\x20+/g, ',' ) + ','\n    R = R.replace /,ɝ,/g,           ',ɜ,r,'\n    R = R.replace /,/g,             ''\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  ipa_from_britfone_ipa_raw: ( ipa_raw ) ->\n    R = ipa_raw\n    R = R.replace /\\x20+/g, ''\n    # R = ',' + ( R.replace /\\x20+/g, ',' ) + ','\n    # # R = R.replace /,ɝ,/g,           ',ɜ,r,'\n    # R = R.replace /,/g,             ''\n    return R\n\n  #---------------------------------------------------------------------------------------------------------\n  _get_bracketed_nr: ( word ) ->\n    nr    = 1\n    word  = word.replace /\\((\\d+)\\)$/, ( $0, $1, index ) =>\n      nr = parseInt $1, 10\n      return ''\n    return { word, nr, }\n\n  #---------------------------------------------------------------------------------------------------------\n  _rewrite_beep_word: ( word ) ->\n    R = word\n    R = R.replace /_/g,     '\\x20'\n    R = R.replace /\\\\'a/g,  'á'\n    R = R.replace /\\\\`a/g,  'à'\n    R = R.replace /\\\\\\^a/g, 'â'\n    R = R.replace /\\\\'e/g,  'é'\n    R = R.replace /\\\\`e/g,  'è'\n    R = R.replace /\\\\\\^e/g, 'ê'\n    R = R.replace /\\\\\\^o/g, 'ô'\n    return R\n\n\n\n"
  ]
}